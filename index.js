const express = require("express");
const cors = require("cors");
const path = require("path");
const { trace } = require("console");
const Traceroute = require("nodejs-traceroute");

const app = express();
const port = process.env.PORT || 3000;
// const dominio = 'www.RouteTracerUDFJC.com'

const abrev = {
  NA1: 0,
  NA2: 1,
  CA1: 2,
  CA2: 3,
  SA1: 4,
  SA2: 5,
  EUR1: 6,
  EUR2: 7,
  OCE1: 8,
  OCE2: 9,
  AFR1: 10,
  AFR2: 11,
};

let tracerts = [
  {
    //Seattle
    NA1: {
      google: {
        saltos: [
          { number: 1, nodo: "38.91.102.1", t: [0.188, "*", 0.195] },
          { number: 2, nodo: "206.81.80.17", t: [1.273, 1.317, 1.364] },
          { number: 3, nodo: "108.170.245.97", t: [1.801, 1.812, 1.825] },
          { number: 4, nodo: "142.251.50.243", t: [0.659, 0.731, 0.737] },
          { number: 5, nodo: "142.251.33.78", t: [0.37, 0.38, 0.383] },
        ],
      },
      youtube: {
        saltos: [
          { number: 1, nodo: "38.91.102.1", t: [0.322, "*", 0.321] },
          { number: 2, nodo: "206.81.80.17", t: [0.495, 0.508, 0.521] },
          { number: 3, nodo: "108.170.245.97", t: [1.444, 1.458, 1.584] },
          { number: 4, nodo: "142.251.50.243", t: [0.639, 0.684, 0.695] },
          { number: 5, nodo: "142.251.33.78", t: [0.414, 0.423, 0.426] },
        ],
      },
      facebook: {
        saltos: [
          { number: 1, nodo: "167.160.89.89", t: [1.024, "*", 1.012] },
          { number: 2, nodo: "167.160.89.1", t: [0.241, 0.261, 0.311] },
          { number: 3, nodo: "223.165.7.204", t: [0.365, 0.369, 0.371] },
          { number: 4, nodo: "223.165.7.164", t: [29.502, 29.602, 29.607] },
          { number: 5, nodo: "103.137.13.206", t: [29.527, 29.601, 29.631] },
          { number: 6, nodo: "206.72.211.15", t: [29.916, 30.441, 30.43] },
          { number: 7, nodo: "157.240.51.161", t: [29.702, 29.724, 29.724] },
          { number: 8, nodo: "157.240.38.235", t: [29.653, 29.71, 29.709] },
          { number: 9, nodo: "31.13.70.36", t: [29.618, 29.566, 29.612] },
        ],
      },
    },
  },
  {
    //Phoenix
    NA2: {
      google: {
        saltos: [
          { number: 1, nodo: "66.85.139.1", t: [0.123, "*", 0.172] },
          { number: 2, nodo: "Internal", t: [0.183, 0.254, 0.267] },
          { number: 3, nodo: "108.170.0.30", t: [0.144, 0.182, 0.218] },
          { number: 4, nodo: "72.29.197.25", t: [2.638, 2.646, 2.722] },
          { number: 5, nodo: "89.149.130.90", t: [8.374, 8.393, 8.394] },
          { number: 6, nodo: "216.221.156.186", t: [10.73, 10.609, 10.578] },
          { number: 7, nodo: "142.251.226.191", t: [8.742, 8.769, 8.762] },
          { number: 8, nodo: "142.251.60.133", t: [8.666, 8.692, 8.685] },
          { number: 9, nodo: "142.250.189.14", t: [8.601, 8.613, 8.601] },
        ],
      },
      youtube: {
        saltos: [
          { number: 1, nodo: "38.91.102.1", t: [0.215, "*", 0.25] },
          { number: 2, nodo: "Internal", t: [0.208, 0.282, 0.287] },
          { number: 3, nodo: "108.170.0.38", t: [21.395, 21.411, 21.44] },
          { number: 4, nodo: "Internal", t: [0.568, 0.657, 0.91] },
          { number: 5, nodo: "72.29.197.25", t: [1.231, 1.204, 1.231] },
          { number: 6, nodo: "89.149.136.149", t: [21.834, 22.476, 22.457] },
          { number: 7, nodo: "199.229.230.134", t: [18.947, 18.988, 18.98] },
          { number: 8, nodo: "108.170.243.1", t: [22.402, 22.426, 22.406] },
          { number: 9, nodo: "108.170.243.14", t: [22.767, 22.785, 22.773] },
          { number: 10, nodo: "142.251.246.175", t: [27.506, 27.538, 27.536] },
          { number: 11, nodo: "*", t: ["*", "*", "*"] },
          { number: 12, nodo: "142.251.249.138", t: [18.631, 18.82, 18.801] },
          { number: 13, nodo: "108.170.247.225", t: [18.875, 18.883, 18.857] },
          { number: 14, nodo: "142.251.233.237", t: [19.615, 19.604, 19.579] },
          { number: 15, nodo: "142.251.40.46", t: [19.068, 19.062, 19.043] },
        ],
      },
      facebook: {
        saltos: [
          { number: 1, nodo: "184.164.133.97", t: [0.548, "*", 0.777] },
          { number: 2, nodo: "Internal", t: [2.288, 2.535, 2.545] },
          { number: 3, nodo: "108.170.0.38", t: [0.221, 0.47, 0.492] },
          { number: 4, nodo: "223.165.7.92", t: [0.324, 0.573, 0.582] },
          { number: 5, nodo: "31.217.251.244", t: [0.466, 0.485, 0.49] },
          { number: 6, nodo: "223.165.7.58", t: [7.659, 7.577, 7.818] },
          { number: 7, nodo: "103.137.13.206", t: [7.57, 7.805, 7.81] },
          { number: 8, nodo: "206.72.211.15", t: [9.046, 9.054, 9.643] },
          { number: 9, nodo: "157.240.51.63", t: [8.643, 8.385, 8.409] },
          { number: 10, nodo: "157.240.39.19", t: [9.112, 9.12, 9.35] },
          { number: 11, nodo: "157.240.11.35", t: [8.376, 8.383, 8.622] },
        ],
      },
    },
  },
  {
    //Ciudad de Mexico
    CA1: {
      google: {
        saltos: [
          { number: 1, nodo: "*", t: ["*", "*", "*"] },
          { number: 2, nodo: "100.100.100.1", t: [0.262, 0.289, 0.336] },
          { number: 3, nodo: "Internal", t: [0.866, 0.894, 0.897] },
          { number: 4, nodo: "Internal", t: [0.853, 1.254, 1.294] },
          { number: 5, nodo: "Internal", t: [6.016, 6.034, 6.035] },
          { number: 6, nodo: "63.222.89.45", t: [0.778, 0.814, 0.822] },
          { number: 7, nodo: "63.218.22.70", t: [25.333, 25.461, 25.602] },
          { number: 8, nodo: "72.14.198.112", t: [26.42, 26.427, 26.491] },
          { number: 9, nodo: "142.251.77.143", t: [22.756, 22.776, 22.735] },
          { number: 10, nodo: "108.170.252.130", t: [35.382, 30.73, 30.716] },
          { number: 11, nodo: "108.170.228.79", t: [25.483, "*", "*"] },
          { number: 12, nodo: "64.233.175.239", t: [24.215, "*", "*"] },
          { number: 13, nodo: "216.239.51.220", t: [25.154, 25.105, 25.117] },
          { number: 14, nodo: "142.250.234.117", t: [25.117, 25.138, 25.102] },
          { number: 15, nodo: "*", t: ["*", "*", "*"] },
          { number: 16, nodo: "*", t: ["*", "*", "*"] },
          { number: 17, nodo: "*", t: ["*", "*", "*"] },
          { number: 18, nodo: "*", t: ["*", "*", "*"] },
          { number: 19, nodo: "*", t: ["*", "*", "*"] },
          { number: 20, nodo: "*", t: ["*", "*", "*"] },
          { number: 21, nodo: "*", t: ["*", "*", "*"] },
          { number: 22, nodo: "*", t: ["*", "*", "*"] },
          { number: 23, nodo: "*", t: ["*", "*", "*"] },
          { number: 24, nodo: "142.250.138.138", t: [23.483, 23.51, 23.509] },
        ],
      },
      youtube: {
        saltos: [
          { number: 1, nodo: "100.76.0.1", t: [2.067, "*", 2.0] },
          { number: 2, nodo: "Internal", t: [3.541, 3.215, 3.213] },
          { number: 3, nodo: "Internal", t: [19.149, 19.509, 19.71] },
          { number: 4, nodo: "*", t: ["*", "*", "*"] },
          { number: 5, nodo: "Internal", t: [11.531, 11.751, 12.1] },
          { number: 6, nodo: "Internal", t: [8.652, 6.935, 6.115] },
          { number: 7, nodo: "Internal", t: [1.228, 1.391, 1.458] },
          { number: 8, nodo: "Internal", t: [2.487, 2.876, 2.586] },
          { number: 9, nodo: "*", t: ["*", "*", "*"] },
          { number: 10, nodo: "Internal", t: [4.062, 4.167, 4.281] },
          { number: 11, nodo: "201.96.74.118", t: [5.94, 5.999, 5.692] },
          { number: 12, nodo: "189.246.170.226", t: [8.501, 8.442, 8.433] },
          { number: 13, nodo: "72.14.242.160", t: [34.825, 34.786, 34.827] },
          { number: 14, nodo: "142.251.250.35", t: [35.574, 35.694, 35.496] },
          { number: 15, nodo: "142.250.211.83", t: [34.883, 34.685, 34.466] },
          { number: 16, nodo: "142.250.81.78", t: [34.61, 34.559, 34.526] },
        ],
      },
      facebook: {
        saltos: [
          { number: 1, nodo: "*", t: ["*", "*", "*"] },
          { number: 2, nodo: "100.100.200.1", t: [0.258, 0.279, 0.297] },
          { number: 3, nodo: "Internal", t: [2.084, 2.158, 2.162] },
          { number: 4, nodo: "Internal", t: [0.886, 1.152, 1.182] },
          { number: 5, nodo: "62.115.188.140", t: [0.534, 0.545, 0.562] },
          { number: 6, nodo: "62.115.124.48", t: [0.68, 0.526, 0.566] },
          { number: 7, nodo: "62.115.123.229", t: [12.25, 12.263, 12.295] },
          { number: 8, nodo: "62.115.123.236", t: [22.718, 22.627, 22.556] },
          { number: 9, nodo: "62.115.36.113", t: [29.94, 29.961, 29.7] },
          { number: 10, nodo: "147.75.217.158", t: [29.496, 29.499, 29.524] },
          { number: 11, nodo: "147.75.217.187", t: [29.483, 29.532, 29.478] },
          { number: 12, nodo: "157.240.36.57", t: [29.508, 29.48, 29.481] },
          { number: 13, nodo: "31.13.93.35", t: [23.913, 23.91, 23.865] },
        ],
      },
    },
  },
  {
    //Queretaro
    CA2: {
      google: {
        saltos: [
          { number: 1, nodo: "Internal", t: [1.655, "*", 1.627] },
          { number: 2, nodo: "Internal", t: [1.628, 1.632, 1.635] },
          { number: 3, nodo: "Internal", t: [1.636, 1.638, 1.64] },
          { number: 4, nodo: "38.122.40.241", t: [1.642, 1.644, 2.013] },
          { number: 5, nodo: "154.24.29.221", t: [2.733, 2.79, 2.934] },
          { number: 6, nodo: "154.54.90.38", t: [10.507, 9.118, 9.112] },
          { number: 7, nodo: "154.54.91.193", t: [12.209, 12.244, 12.582] },
          { number: 8, nodo: "154.54.47.33", t: [20.362, 20.597, 20.651] },
          { number: 9, nodo: "154.54.41.66", t: [25.38, 25.437, 25.449] },
          { number: 10, nodo: "154.54.28.74", t: [25.918, 25.957, 25.962] },
          { number: 11, nodo: "154.54.12.106", t: [25.22, 24.826, 24.83] },
          { number: 12, nodo: "209.85.172.106", t: [26.304, 26.538, 26.251] },
          { number: 13, nodo: "142.251.248.209", t: [24.83, 24.743, 24.907] },
          { number: 14, nodo: "142.251.60.53", t: [24.56, 24.603, 24.968] },
          { number: 15, nodo: "142.251.33.46", t: [24.539, 24.412, 24.435] },
        ],
      },
      youtube: {
        saltos: [
          { number: 1, nodo: "Internal", t: [1.187, "*", 1.178] },
          { number: 2, nodo: "Internal", t: [1.175, 1.172, 1.17] },
          { number: 3, nodo: "Internal", t: [1.168, 1.166, 1.165] },
          { number: 4, nodo: "38.122.40.241", t: [1.282, 1.305, 1.33] },
          { number: 5, nodo: "154.24.29.221", t: [2.27, 2.303, 2.37] },
          { number: 6, nodo: "154.54.90.38", t: [10.352, 9.447, 9.44] },
          { number: 7, nodo: "154.54.91.193", t: [12.849, 12.889, 13.083] },
          { number: 8, nodo: "154.54.47.33", t: [19.793, 19.845, 19.877] },
          { number: 9, nodo: "154.54.41.66", t: [24.929, 24.987, 25.074] },
          { number: 10, nodo: "154.54.28.74", t: [25.461, 25.507, 25.551] },
          { number: 11, nodo: "154.54.12.106", t: [26.489, 24.983, 25.001] },
          { number: 12, nodo: "209.85.172.106", t: [26.54, 26.57, 26.39] },
          { number: 13, nodo: "142.251.248.205", t: [25.4, 25.391, 25.412] },
          { number: 14, nodo: "142.250.62.203", t: [24.684, 24.715, 24.829] },
          { number: 15, nodo: "142.251.40.78", t: [24.547, 24.553, 24.581] },
        ],
      },
      facebook: {
        saltos: [
          { number: 1, nodo: "Internal", t: [1.144, "*", 1.125] },
          { number: 2, nodo: "Internal", t: [1.123, 1.122, 1.122] },
          { number: 3, nodo: "Internal", t: [1.121, 1.119, 1.118] },
          { number: 4, nodo: "38.122.41.25", t: [1.157, 1.32, 1.561] },
          { number: 5, nodo: "154.24.29.221", t: [2.442, 2.517, 2.561] },
          { number: 6, nodo: "154.54.46.81", t: [10.162, 9.568, 9.567] },
          { number: 7, nodo: "154.54.91.205", t: [12.665, 12.731, 13.007] },
          { number: 8, nodo: "154.54.47.45", t: [19.891, 19.933, 19.954] },
          { number: 9, nodo: "154.54.6.78", t: [21.073, 21.111, 21.297] },
          { number: 10, nodo: "38.140.14.98", t: [21.468, 21.509, 21.712] },
          { number: 11, nodo: "129.134.37.237", t: [21.468, 20.627, 20.63] },
          { number: 12, nodo: "173.252.67.55", t: [20.134, 20.142, 20.068] },
          { number: 13, nodo: "157.240.24.35", t: [20.439, 20.466, 20.613] },
        ],
      },
    },
  },
  {
    //Santiago de chile
    SA1: {
      google: {
        saltos: [
          { number: 1, nodo: "*", t: ["*", "*", "*"] },
          { number: 2, nodo: "100.100.200.1", t: [0.287, 0.317, 0.317] },
          { number: 3, nodo: "Internal", t: [7.241, 7.252, 7.252] },
          { number: 4, nodo: "Internal", t: [0.301, 0.312, 0.31] },
          { number: 5, nodo: "Internal", t: [0.888, 0.89, 0.89] },
          { number: 6, nodo: "72.14.216.9", t: [1.221, 0.926, 0.887] },
          { number: 7, nodo: "72.14.216.8", t: [3.573, 3.618, 3.649] },
          { number: 8, nodo: "142.251.194.211", t: [2.101, 2.056, 2.165] },
          { number: 9, nodo: "74.125.252.3", t: [2.715, 2.411, 2.424] },
          { number: 10, nodo: "142.251.253.85", t: [1.716, 1.737, 1.666] },
          { number: 11, nodo: "142.250.229.119", t: [2.465, 2.43, 2.624] },
          { number: 12, nodo: "*", t: ["*", "*", "*"] },
          { number: 13, nodo: "*", t: ["*", "*", "*"] },
          { number: 14, nodo: "*", t: ["*", "*", "*"] },
          { number: 15, nodo: "*", t: ["*", "*", "*"] },
          { number: 16, nodo: "*", t: ["*", "*", "*"] },
          { number: 17, nodo: "*", t: ["*", "*", "*"] },
          { number: 18, nodo: "*", t: ["*", "*", "*"] },
          { number: 19, nodo: "*", t: ["*", "*", "*"] },
          { number: 20, nodo: "*", t: ["*", "*", "*"] },
          { number: 21, nodo: "64.233.190.138", t: [1.368, 1.377, 1.212] },
        ],
      },
      youtube: {
        saltos: [
          { number: 1, nodo: "148.163.223.1", t: [1.211, "*", 1.244] },
          { number: 2, nodo: "*", t: ["*", "*", "*"] },
          { number: 3, nodo: "*", t: ["*", "*", "*"] },
          { number: 4, nodo: "74.125.242.6", t: [18.218, 18.27, 18.27] },
          { number: 5, nodo: "142.250.215.221", t: [0.933, 0.961, 0.974] },
          { number: 6, nodo: "142.251.253.85", t: [12.849, 12.889, 13.083] },
          { number: 7, nodo: "142.250.229.63", t: [1.465, 1.341, 1.431] },
          { number: 8, nodo: "*", t: ["*", "*", "*"] },
          { number: 9, nodo: "*", t: ["*", "*", "*"] },
          { number: 10, nodo: "*", t: ["*", "*", "*"] },
          { number: 11, nodo: "*", t: ["*", "*", "*"] },
          { number: 12, nodo: "*", t: ["*", "*", "*"] },
          { number: 13, nodo: "*", t: ["*", "*", "*"] },
          { number: 14, nodo: "*", t: ["*", "*", "*"] },
          { number: 15, nodo: "*", t: ["*", "*", "*"] },
          { number: 16, nodo: "*", t: ["*", "*", "*"] },
          { number: 17, nodo: "172.217.192.190", t: [0.571, 0.607, 0.596] },
        ],
      },
      facebook: {
        saltos: [
          { number: 1, nodo: "*", t: ["*", "*", "*"] },
          { number: 2, nodo: "100.100.100.1", t: [0.237, 0.272, 0.295] },
          { number: 3, nodo: "Internal", t: [3.029, 3.049, 3.056] },
          { number: 4, nodo: "Internal", t: [0.485, 0.506, 0.511] },
          { number: 5, nodo: "Internal", t: [0.38, 0.413, 0.428] },
          { number: 6, nodo: "45.68.16.205", t: [2.079, 1.844, 1.84] },
          { number: 7, nodo: "31.13.26.29", t: [0.92, 0.917, 0.919] },
          { number: 8, nodo: "173.252.67.67", t: [0.97, 0.957, 0.973] },
          { number: 9, nodo: "157.240.204.35", t: [0.815, 0.823, 0.814] },
        ],
      },
    },
  },
  {
    //Rio de Janeiro
    SA2: {
      google: {
        saltos: [
          { number: 1, nodo: "186.226.58.1", t: [0.271, "*", 0.214] },
          { number: 2, nodo: "200.186.63.117", t: [1.21, 1.209, 1.199] },
          { number: 3, nodo: "4.68.37.162", t: [1.612, 1.617, 1.963] },
          { number: 4, nodo: "142.250.228.65", t: [0.532, 0.534, 0.524] },
          { number: 5, nodo: "142.250.39.115", t: [0.763, 0.759, 0.74] },
          { number: 6, nodo: "172.253.71.98", t: [114.06, 113.18, 113.224] },
          { number: 7, nodo: "142.251.61.217", t: [130.854, 130.841, 130.8] },
          { number: 8, nodo: "142.250.233.170", t: [130.18, 130.169, 130.388] },
          { number: 9, nodo: "108.170.228.90", t: [129.266, 129.238, 129.216] },
          { number: 10, nodo: "108.170.252.161", t: [130.021, 130.0, 130.201] },
          { number: 11, nodo: "142.251.60.47", t: [129.199, 129.154, 129.187] },
          {
            number: 12,
            nodo: "142.251.32.174",
            t: [128.916, 128.984, 128.965],
          },
        ],
      },
      youtube: {
        saltos: [
          { number: 1, nodo: "186.226.58.1", t: [0.236, "*", 0.171] },
          { number: 2, nodo: "200.186.63.117", t: [0.567, 0.563, 0.535] },
          { number: 3, nodo: "4.68.37.162", t: [1.724, 2.082, 2.061] },
          { number: 4, nodo: "108.170.248.241", t: [1.753, 1.735, 1.856] },
          { number: 5, nodo: "108.170.248.243", t: [0.773, 0.781, 0.952] },
          { number: 6, nodo: "172.253.71.98", t: [113.565, 114.047, 113.995] },
          { number: 7, nodo: "142.251.61.217", t: [130.293, 130.278, 130.417] },
          { number: 8, nodo: "142.251.70.210", t: [130.659, 130.766, 130.755] },
          {
            number: 9,
            nodo: "108.170.233.118",
            t: [130.581, 130.577, 130.563],
          },
          {
            number: 10,
            nodo: "108.170.252.129",
            t: [129.159, 129.181, 129.163],
          },
          { number: 11, nodo: "142.251.253.27", t: [129.213, 129.156, 129.14] },
          { number: 12, nodo: "172.217.11.78", t: [129.266, 129.233, 129.212] },
        ],
      },
      facebook: {
        saltos: [
          { number: 1, nodo: "186.226.60.16", t: [0.263, "*", 0.212] },
          { number: 2, nodo: "189.45.5.217", t: [0.721, 0.718, 0.824] },
          { number: 3, nodo: "189.45.5.121", t: [1.15, 1.42, 1.697] },
          { number: 4, nodo: "187.16.218.82", t: [10.11, 10.095, 10.065] },
          { number: 5, nodo: "129.134.41.6", t: [9.24, 9.233, 9.307] },
          { number: 6, nodo: "147.75.214.181", t: [9.171, 9.169, 9.126] },
          { number: 7, nodo: "173.252.67.161", t: [21.485, 21.488, 21.477] },
          { number: 8, nodo: "31.13.85.36", t: [8.625, 8.623, 8.588] },
        ],
      },
    },
  },
  {
    //Barcelona
    EUR1: {
      google: {
        saltos: [
          { number: 1, nodo: "*", t: ["*", "*", "*"] },
          { number: 2, nodo: "213.27.141.121", t: [0.774, 0.807, 0.809] },
          { number: 3, nodo: "212.74.66.239", t: [9.262, 9.502, 9.51] },
          { number: 4, nodo: "212.74.66.239", t: [9.007, 9.044, 9.047] },
          { number: 5, nodo: "72.14.219.70", t: [12.16, 12.233, 12.243] },
          { number: 6, nodo: "74.125.242.161", t: [9.448, 9.14, 9.119] },
          { number: 7, nodo: "74.125.37.87", t: [8.838, 9.0, 9.004] },
          { number: 8, nodo: "142.250.201.78", t: [8.769, 8.838, 8.831] },
        ],
      },
      youtube: {
        saltos: [
          { number: 1, nodo: "185.166.214.1", t: [0.233, "*", 0.374] },
          { number: 2, nodo: "213.27.141.121", t: [0.981, 1.037, 1.09] },
          { number: 3, nodo: "212.74.66.239", t: [9.872, 9.937, 9.991] },
          { number: 4, nodo: "212.74.66.239", t: [8.887, 8.991, 9.082] },
          { number: 5, nodo: "72.14.219.70", t: [9.207, 9.274, 9.33] },
          { number: 6, nodo: "74.125.242.177", t: [10.517, 13.533, 13.644] },
          { number: 7, nodo: "142.250.46.167", t: [10.084, 10.21, 10.276] },
          { number: 8, nodo: "216.58.209.78", t: [9.022, 9.049, 9.049] },
        ],
      },
      facebook: {
        saltos: [
          { number: 1, nodo: "*", t: ["*", "*", "*"] },
          { number: 2, nodo: "5.154.10.150", t: [0.709, 0.721, 0.721] },
          { number: 3, nodo: "*", t: ["*", "*", "*"] },
          { number: 4, nodo: "*", t: ["*", "*", "*"] },
          { number: 5, nodo: "*", t: ["*", "*", "*"] },
          { number: 6, nodo: "129.134.45.56", t: [28.178, 27.953, 28.157] },
          { number: 7, nodo: "129.134.54.183", t: [28.69, 28.666, 28.655] },
          { number: 8, nodo: "173.252.67.183", t: [28.65, 28.619, 28.454] },
          { number: 9, nodo: "157.240.221.35", t: [28.795, 28.809, 28.829] },
        ],
      },
    },
  },
  {
    //Edimburgo
    EUR2: {
      google: {
        saltos: [
          { number: 1, nodo: "82.113.128.97", t: [0.474, "*", 0.444] },
          { number: 2, nodo: "134.19.160.225", t: [10.758, 10.794, 10.795] },
          { number: 3, nodo: "82.113.152.10", t: [11.436, 11.51, 11.52] },
          { number: 4, nodo: "195.66.224.125", t: [11.507, 11.53, 11.532] },
          { number: 5, nodo: "108.170.246.161", t: [11.957, 11.983, 12.092] },
          { number: 6, nodo: "142.251.54.27", t: [11.204, 12.271, 12.259] },
          { number: 7, nodo: "142.250.179.238", t: [11.095, 11.097, 11.085] },
        ],
      },
      youtube: {
        saltos: [
          { number: 1, nodo: "82.113.128.97", t: [1.834, "*", 1.834] },
          { number: 2, nodo: "134.19.160.225", t: [0.649, 10.697, 10.675] },
          { number: 3, nodo: "82.113.152.10", t: [11.06, 11.087, 11.088] },
          { number: 4, nodo: "195.66.224.125", t: [13.445, 13.471, 13.473] },
          { number: 5, nodo: "74.125.242.97", t: [12.754, 12.773, 12.809] },
          { number: 6, nodo: "142.251.52.145", t: [11.689, 11.717, 11.679] },
          { number: 7, nodo: "142.250.200.46", t: [11.778, 11.78, 11.774] },
        ],
      },
      facebook: {
        saltos: [
          { number: 1, nodo: "82.113.128.97", t: [0.784, "*", 0.792] },
          { number: 2, nodo: "212.187.195.153", t: [9.48, 9.527, 9.529] },
          { number: 3, nodo: "*", t: ["*", "*", "*"] },
          { number: 4, nodo: "4.68.37.210", t: [73.409, 73.454, 73.455] },
          { number: 5, nodo: "157.240.45.132", t: [22.816, 22.856, 22.853] },
          { number: 6, nodo: "157.240.33.113", t: [22.883, 22.897, 22.89] },
          { number: 7, nodo: "173.252.67.237", t: [22.995, 22.995, 23.069] },
          { number: 8, nodo: "157.240.20.35", t: [22.892, 22.915, 22.912] },
        ],
      },
    },
  },
  {
    //Brisbane
    OCE1: {
      google: {
        saltos: [
          { number: 1, nodo: "103.16.128.2", t: [0.581, "*", 0.595] },
          { number: 2, nodo: "103.17.56.17", t: [12.099, 12.144, 12.224] },
          { number: 3, nodo: "74.125.52.4", t: [12.967, 12.982, 12.985] },
          { number: 4, nodo: "108.170.247.81", t: [12.33, 12.376, 12.398] },
          { number: 5, nodo: "216.239.57.119", t: [12.976, 12.984, 12.986] },
          { number: 6, nodo: "172.217.24.46", t: [12.973, 12.542, 12.529] },
        ],
      },
      youtube: {
        saltos: [
          { number: 1, nodo: "103.16.128.2", t: [1.489, "*", 1.462] },
          { number: 2, nodo: "103.17.56.17", t: [12.276, 12.429, 12.431] },
          { number: 3, nodo: "74.125.52.4", t: [12.874, 12.964, 13.03] },
          { number: 4, nodo: "108.170.247.81", t: [12.784, 12.86, 12.921] },
          { number: 5, nodo: "216.239.57.119", t: [13.557, 13.614, 13.661] },
          { number: 6, nodo: "172.217.24.46", t: [13.766, 12.49, 12.452] },
        ],
      },
      facebook: {
        saltos: [
          { number: 1, nodo: "103.16.128.2", t: [0.947, "*", 0.948] },
          { number: 2, nodo: "103.17.56.17", t: [12.358, 12.415, 12.42] },
          { number: 3, nodo: "218.100.52.169", t: [21.23, 21.322, 21.307] },
          { number: 4, nodo: "129.134.78.194", t: [13.133, 13.16, 13.225] },
          { number: 5, nodo: "129.134.79.1", t: [13.237, 13.265, 13.565] },
          { number: 6, nodo: "173.252.67.27", t: [13.581, 12.481, 12.523] },
          { number: 7, nodo: "157.240.8.35", t: [12.64, 12.648, 12.641] },
        ],
      },
    },
  },
  {
    //Adelaide
    OCE2: {
      google: {
        saltos: [
          { number: 1, nodo: "116.206.231.5", t: [10.718, "*", 10.707] },
          { number: 2, nodo: "203.209.218.48", t: [0.509, 0.534, 0.534] },
          { number: 3, nodo: "103.52.119.61", t: [10.923, 10.959, 11.083] },
          { number: 4, nodo: "103.26.71.80", t: [9.811, 9.85, 9.85] },
          { number: 5, nodo: "103.26.71.181", t: [10.705, 10.694, 10.692] },
          { number: 6, nodo: "172.253.53.97", t: [10.935, 11.137, 11.13] },
          { number: 7, nodo: "216.239.54.51", t: [10.521, 10.764, 10.752] },
          { number: 8, nodo: "142.250.70.206", t: [10.119, 9.912, 9.873] },
        ],
      },
      youtube: {
        saltos: [
          { number: 1, nodo: "116.206.231.5", t: [12.787, "*", 12.782] },
          { number: 2, nodo: "203.209.218.48", t: [0.279, 0.307, 0.31] },
          { number: 3, nodo: "103.52.119.61", t: [9.888, 9.933, 10.03] },
          { number: 4, nodo: "103.26.71.80", t: [9.561, 9.593, 9.623] },
          { number: 5, nodo: "103.26.71.181", t: [10.165, 10.174, 10.207] },
          { number: 6, nodo: "172.253.53.81", t: [9.855, 9.83, 10.027] },
          { number: 7, nodo: "142.250.230.157", t: [10.723, 11.037, 11.016] },
          { number: 8, nodo: "142.250.70.174", t: [9.854, 9.852, 9.868] },
        ],
      },
      facebook: {
        saltos: [
          { number: 1, nodo: "116.206.231.5", t: [20.362, "*", 20.345] },
          { number: 2, nodo: "203.209.218.48", t: [0.23, 0.249, 0.278] },
          { number: 3, nodo: "45.112.244.170", t: [18.487, 18.509, 18.569] },
          { number: 4, nodo: "103.52.116.151", t: [18.394, 18.452, 18.449] },
          { number: 5, nodo: "45.127.172.2", t: [18.206, 18.238, 18.239] },
          { number: 6, nodo: "45.127.172.39", t: [21.746, 21.632, 21.602] },
          { number: 7, nodo: "129.134.78.194", t: [18.473, 18.551, 18.508] },
          { number: 8, nodo: "129.134.79.5", t: [18.562, 18.549, 18.522] },
          { number: 9, nodo: "157.240.38.73", t: [18.579, 18.588, 18.591] },
          { number: 10, nodo: "157.240.8.35", t: [18.132, 18.096, 18.096] },
        ],
      },
    },
  },
  {
    //Lagos - Nigeria
    AFR1: {
      google: {
        saltos: [
          { number: 1, nodo: "185.174.62.18", t: [0.188, "*", 0.175] },
          { number: 2, nodo: "102.165.2.21", t: [0.296, 0.298, 0.295] },
          { number: 3, nodo: "102.134.19.52", t: [0.951, 0.955, 0.954] },
          { number: 4, nodo: "72.14.222.48", t: [1.265, 1.276, 1.335] },
          { number: 5, nodo: "108.170.240.17", t: [1.774, 1.811, 1.849] },
          { number: 6, nodo: "172.253.76.217", t: [2.046, 2.262, 2.268] },
          { number: 7, nodo: "216.58.223.238", t: [1.062, 1.067, 1.083] },
        ],
      },
      youtube: {
        saltos: [
          { number: 1, nodo: "185.174.62.18", t: [0.303, "*", 0.295] },
          { number: 2, nodo: "102.165.2.21", t: [0.361, 0.35, 0.35] },
          { number: 3, nodo: "102.134.19.52", t: [1.662, 1.667, 1.697] },
          { number: 4, nodo: "72.14.222.48", t: [1.247, 1.252, 1.319] },
          { number: 5, nodo: "108.170.240.17", t: [1.646, 1.637, 1.707] },
          { number: 6, nodo: "172.253.76.217", t: [2.303, 1.913, 1.927] },
          { number: 7, nodo: "216.58.223.238", t: [1.116, 1.145, 1.156] },
        ],
      },
      facebook: {
        saltos: [
          { number: 1, nodo: "185.174.62.18", t: [46.394, "*", 46.416] },
          { number: 2, nodo: "102.134.18.1", t: [3.414, 3.421, 3.421] },
          { number: 3, nodo: "154.66.247.146", t: [94.198, 94.239, 94.352] },
          { number: 4, nodo: "154.66.247.71", t: [93.752, 93.755, 93.754] },
          { number: 5, nodo: "157.240.75.78", t: [93.89, 93.891, 93.88] },
          { number: 6, nodo: "129.134.45.56", t: [93.491, 93.46, 93.477] },
          { number: 7, nodo: "129.134.42.35", t: [93.968, 94.09, 94.099] },
          { number: 8, nodo: "157.240.38.69", t: [94.081, 94.078, 94.074] },
          { number: 9, nodo: "157.240.221.35", t: [93.652, 93.669, 93.654] },
        ],
      },
    },
  },
  {
    //Tel Aviv - Israel
    AFR2: {
      google: {
        saltos: [
          { number: 1, nodo: "91.228.126.2", t: [0.306, "*", 0.306] },
          { number: 2, nodo: "212.116.176.249", t: [11.159, 11.176, 11.173] },
          { number: 3, nodo: "142.250.169.119", t: [1.097, 1.147, 1.161] },
          { number: 4, nodo: "142.250.169.118", t: [1.784, 1.838, 1.84] },
          { number: 5, nodo: "216.239.50.169", t: [2.215, 2.27, 2.275] },
          { number: 6, nodo: "72.14.237.235", t: [2.984, 3.088, 3.016] },
          { number: 7, nodo: "172.217.22.78", t: [2.787, 2.809, 2.8] },
        ],
      },
      youtube: {
        saltos: [
          { number: 1, nodo: "5.188.95.2", t: [0.106, "*", 0.169] },
          { number: 2, nodo: "Internal", t: [0.158, 0.213, 0.222] },
          { number: 3, nodo: "31.168.224.93", t: [0.275, 0.294, 0.303] },
          { number: 4, nodo: "62.219.189.185", t: [0.47, 0.572, 0.633] },
          { number: 5, nodo: "*", t: ["*", "*", "*"] },
          { number: 6, nodo: "72.14.211.60", t: [1.553, 1.654, 1.657] },
          { number: 7, nodo: "142.251.231.41", t: [4.132, 4.154, 4.233] },
          { number: 8, nodo: "142.251.240.179", t: [2.03, 2.045, 2.047] },
          { number: 9, nodo: "142.251.37.78", t: [2.043, 2.047, 2.038] },
        ],
      },
      facebook: {
        saltos: [
          { number: 1, nodo: "91.228.126.3", t: [0.211, "*", 0.239] },
          { number: 2, nodo: "212.116.177.49", t: [0.517, 0.55, 0.549] },
          { number: 3, nodo: "*", t: ["*", "*", "*"] },
          { number: 4, nodo: "*", t: ["*", "*", "*"] },
          { number: 5, nodo: "82.102.132.77", t: [1.443, 1.485, 1.485] },
          { number: 6, nodo: "82.102.132.78", t: [1.48, 1.549, 1.55] },
          { number: 7, nodo: "80.179.166.85", t: [54.345, 54.379, 54.379] },
          { number: 8, nodo: "80.81.194.40", t: [96.166, 96.218, 96.202] },
          { number: 9, nodo: "204.15.20.30", t: [58.401, 58.467, 58.389] },
          { number: 10, nodo: "129.134.39.45", t: [57.746, 57.758, 57.756] },
          { number: 11, nodo: "157.240.38.179", t: [58.897, 59.299, 59.314] },
          { number: 12, nodo: "157.240.252.35", t: [58.289, 58.299, 58.294] },
        ],
      },
    },
  },
];

let tracertsLocal = {
  google: {
    saltos: [
      { number: 1, nodo: "190.120.231.1", t: [0.222, "*", 0.206] },
      { number: 2, nodo: "Internal", t: [0.231, 0.234, 0.229] },
      { number: 3, nodo: "190.60.105.89", t: [0.965, 0.976, 0.971] },
      { number: 4, nodo: "Internal", t: [67.031, 67.049, 67.084] },
      { number: 5, nodo: "*", t: ["*", "*", "*"] },
      { number: 6, nodo: "142.251.193.2", t: [66.783, 67.262, 67.248] },
      { number: 7, nodo: "142.250.60.151", t: [68.522, 68.523, 68.509] },
      { number: 8, nodo: "142.251.236.140", t: [86.24, 86.451, 86.659] },
      { number: 9, nodo: "142.251.54.178", t: [85.662, 85.68, 85.666] },
      { number: 10, nodo: "74.125.242.209", t: [85.89, 86.09, 86.091] },
      { number: 11, nodo: "142.251.239.193", t: [86.712, 86.704, 86.693] },
      { number: 12, nodo: "142.251.134.78", t: [86.871, 86.852, 86.84] },
    ],
  },
  youtube: {
    saltos: [
      { number: 1, nodo: "190.120.231.1", t: [0.147, "*", 0.139] },
      { number: 2, nodo: "Internal", t: [0.247, 0.256, 0.251] },
      { number: 3, nodo: "190.60.105.89", t: [0.983, 0.991, 0.987] },
      { number: 4, nodo: "Internal", t: [67.022, 67.055, 67.08] },
      { number: 5, nodo: "*", t: ["*", "*", "*"] },
      { number: 6, nodo: "74.125.242.24", t: [67.251, 67.637, 67.598] },
      { number: 7, nodo: "142.250.214.76", t: [67.73, 67.74, 67.731] },
      { number: 8, nodo: "142.251.236.146", t: [87.215, 87.218, 87.207] },
      { number: 9, nodo: "108.170.227.119", t: [86.859, 86.867, 86.856] },
      { number: 10, nodo: "74.125.242.193", t: [88.306, 87.683, 87.663] },
      { number: 11, nodo: "142.251.239.159", t: [86.418, 86.451, 86.441] },
      { number: 12, nodo: "142.251.134.14", t: [87.605, 87.604, 87.593] },
    ],
  },
  facebook: {
    saltos: [
      { number: 1, nodo: "190.120.231.1", t: [0.145, "*", 0.121] },
      { number: 2, nodo: "Internal", t: [0.188, 0.184, 0.174] },
      { number: 3, nodo: "190.217.98.245", t: [13.344, 13.318, 13.34] },
      { number: 4, nodo: "4.69.220.6", t: [85.652, 85.597, 85.627] },
      { number: 5, nodo: "157.240.72.214", t: [111.474, 111.487, 111.471] },
      { number: 6, nodo: "129.134.68.160", t: [85.703, 85.777, 85.801] },
      { number: 7, nodo: "129.134.68.233", t: [85.731, 85.834, 85.824] },
      { number: 8, nodo: "157.240.38.139", t: [85.749, 85.783, 85.785] },
      { number: 9, nodo: "31.13.94.19", t: [85.288, 85.312, 85.308] },
    ],
  },
};
let ips = [];
// let ipscoords = [];

function localtr(domain) {
  try {
    const tracer = new Traceroute("ipv4");
    tracer
      .on("pid", (pid) => {
        console.log(`pid: ${pid}`);
      })
      .on("destination", (destination) => {
        console.log(`destination: ${destination}`);
      })
      .on("hop", (hop) => {
        console.log(`hop: ${JSON.stringify(hop)}`);
      })
      .on("close", (code) => {
        console.log(`close: code ${code}`);
      });

    tracer.trace(domain);
  } catch (ex) {
    console.log(ex);
  }
}

function extractIPInfo(query) {
  // console.log(JSON.parse(JSON.stringify(tracerts)));
}

//#region
app.use(
  express.urlencoded({
    extended: true,
  })
);

app.use(
  express.json({
    type: "*/*",
  })
);

var corsOptions = {
  credentials: true,
  origin: `*`,
  optionsSuccessStatus: 200,
};

app.use(cors(corsOptions));
//#endregion

//gets tracerts
//#region
app.get("/tracert", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts));
});

app.get("/tracert/Local", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracertsLocal));
});

app.get("/tracert/NA1", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts[abrev.NA1].NA1));
});
app.get("/tracert/NA2", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts[abrev.NA2].NA2));
});
app.get("/tracert/CA1", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts[abrev.CA1].CA1));
});
app.get("/tracert/CA2", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts[abrev.CA2].CA2));
});
app.get("/tracert/SA1", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts[abrev.SA1].SA1));
});
app.get("/tracert/SA2", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts[abrev.SA2].SA2));
});
app.get("/tracert/EUR1", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts[abrev.EUR1].EUR1));
});
app.get("/tracert/EUR2", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts[abrev.EUR2].EUR2));
});
app.get("/tracert/OCE1", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts[abrev.OCE1].OCE1));
});
app.get("/tracert/OCE2", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts[abrev.OCE2].OCE2));
});
app.get("/tracert/AFR1", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts[abrev.AFR1].AFR1));
});
app.get("/tracert/AFR2", cors(corsOptions), (req, res) => {
  res.send(JSON.stringify(tracerts[abrev.AFR2].AFR2));
});

//#endregion

app.post("/ips", cors(corsOptions), (req, res) => {
  let ipscoords = [];
  ips.length = 0;
  ips = req.body;
  for (let i = 0; i < ips.length; i++) {
    var query = ips[i].ip;
    fetch(`http://ip-api.com/json/${query}?fields=status,lat,lon,isp`)
      .then((x) => x.json())
      .then((data) => {
        ipscoords.push({ n: ips[i].n, data });
        if (ipscoords.length == ips.length) {
          ipscoords = ipscoords.sort((a, b) => (a.n > b.n ? 1 : -1));
          res.send(JSON.stringify(ipscoords));
        }
      });
  }
});

// function IPSinfo(ips) {}

app.listen(port, () => {
  console.log(`Server running on http:://localhost:${port}`);
});
